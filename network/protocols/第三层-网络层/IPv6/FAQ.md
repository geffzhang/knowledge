# K8s 集群中的 IPv6 使用建议？

1. 为了确保节点、Pod 及 Service 的 IP 固定，应该给它们都分配 ULA 地址？
2. 为了确保节点、Pod 都能访问公网，那么它们也都需要 GUA 地址？
3. 那么 GUA 与 ULA 能否共存呢？我设想的情况：
4. **ULA 提供内部网络的固定 IP**: ULA 由用户静态指定，或者由集群内部 ipam 分配。
5. **GUA 提供公网访问能力**: GUA 前缀由 ISP 动态分配，再通过 DHCPv6 或类似机制分配最终 IPv6 地址。
6. 无需 NAT66 网络地址转换，因为**每个 Pod/Node 都同时具备 GUA 与 ULA 地址**。
7. Pod 通过 DHCPv6 获得网关的 GUA，或者通过静态设置获得网关的 ULA
8. **Pod-to-Internet**: 访问公网网络时会使用自身的 GUA 地址发包，然后根据路由规则借助网关的 GUA/ULA 将包路由到网关。
9. **Pod-to-Pod**:
   Pod 访问局域网网络时会使用自身的 ULA 地址发包，然后通过链路层或者局域网网关寻址/路由到目标 Pod.


这个问题的核心是「在同时具有 GUA 与 LLA 的机器上，源地址如何选择？会走什么路由策略？」。



